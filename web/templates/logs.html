{% extends "base.html" %}
{% block title_suffix %} - Logs{% endblock %}

{% block content %}
<h1>Logs</h1>

<div class="log-controls">
    <button class="btn btn-sm" onclick="refreshLogs()">Refresh</button>
    <label class="setting-row">
        <input type="checkbox" id="auto-scroll" checked>
        Auto-scroll
    </label>
</div>

<div class="log-viewer" id="log-viewer">
{% for line in lines %}
<div class="log-line">{{ line }}</div>
{% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script>
var logViewer = document.getElementById('log-viewer');

function scrollToBottom() {
    if (document.getElementById('auto-scroll').checked) {
        logViewer.scrollTop = logViewer.scrollHeight;
    }
}

function refreshLogs() {
    fetch('/api/logs')
        .then(r => r.json())
        .then(data => {
            logViewer.innerHTML = '';
            data.lines.forEach(function(line) {
                var div = document.createElement('div');
                div.className = 'log-line';
                div.textContent = line;
                logViewer.appendChild(div);
            });
            scrollToBottom();
        })
        .catch(() => {});
}

// Auto-refresh every 5 seconds
setInterval(refreshLogs, 5000);

// Scroll to bottom on load
document.addEventListener('DOMContentLoaded', scrollToBottom);
</script>
{% endblock %}
